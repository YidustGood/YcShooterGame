# YcShooter 射击游戏项目架构总览

作者B站：[Yc_奕尘- 有过往开发作品视频](https://space.bilibili.com/179236650)

作者知乎：[知乎-奕尘-技术文章分享](https://www.zhihu.com/people/yi-chen-56-91-92)

引擎版本：[UE5.6.1 AngelScirpt 定制版 需按照UE引擎源码版加入组织开启权限](https://github.com/YidustGood/UnrealEngine-Angelscript)

游戏可玩Demo下载链接：[YcShooterGameDemo](https://pan.quark.cn/s/af63cb4a859b)

---

**本文档讲解项目整体情况，另外两份PDF文档将深入讲解各个核心系统实现思路。**

项目架构总览篇分为 **1、项目概述**、**2、技术选型思路**、**3、整体架构设计** 三个板块展开介绍。

## 一、项目概述

### 1.1 项目介绍

    **YcShooter**  是一个基于 UE5 开发的**模块化射击游戏框架**合理的运用了**GAS** 、**Game Feature**、**DataRegisty**等经过堡垒之夜等大型商业项目验证过的UE5功能特性，为网络射击游戏项目提供完整、高效、可复用的核心系统架构。

    项目采用插件化设计，将通用游戏功能抽象为独立模块，支持快速组装和定制化开发。本项目的重点在于建设了这样一套底层框架支撑, 基于这套框架后续可以快速迭代开发具体的游戏玩法体系。
    该项目由本人从空白项目开始独立开发，学习探索了UE官方推荐的新一代Gameplay框架体系及功能特性。



### 1.2 游戏功能简介

    目前**YcShooter** 项目已经实现了一套**现代化FPS网游的核心游戏体验功能**，目前提供了**个人死亡竞赛**、**团队死亡竞赛**两种游玩模式，可以自定义添加Bot对战，支持创建房间进行Steam联机对战或者局域网对战。提供Dedicated Server实现更加专业的游戏比赛体验，DS服务器实例可通过Google Agonse进行动态伸缩管理按需为玩家提供DS对战服务。[代码仓库Readme中有游戏视频演示链接](https://github.com/YidustGood/YcShooterGame), [CNB仓库链接](https://cnb.cool/ycgamedev/YcShooterGame)

![https://imgloc.com/image/yW6zCX](https://i.imgs.ovh/2026/02/01/yW6g1m.png)

### 1.3 核心功能清单

#### YiChenGameplayCore插件：

**Experience游戏体验框架系统**(GameMode的高级功能扩展)、**技能系统**、**游戏阶段管理系统**、**队伍系统**、**库存系统**、**装备系统**、**交互系统**、**生命系统**、基于GameplayTag布局的UI框架系统、局域网/Steam会话**联机系统**。以上系统均做了完备的**网络同步支持**，并采用FastArray、PushModel等技术优化网络同步性能，装备系统做了额外的客户端预测与回滚机制。

#### YiChenShooterCore插件：

**武器系统**(COD系的射击手感体系)、**配件系统**(可动态装卸影响视觉模型与武器属性)**、伤害系统**（头部、躯干、肢体分区伤害计算、伤害衰减）、**HitScan/Projectile双类型子弹方案**、**子弹对象池系统**(用于Projectile子弹)

#### YiChenRedDotSystem插件：

基于GameplayTag的**通用游戏红点系统**, 可供多个项目复用, 详细设计思路与实现讲解在 **知乎文章已获200+收藏** [UE5通用红点系统设计与实现](https://zhuanlan.zhihu.com/p/1989733418259484688)。



**项目核心价值**：

- **可复用性**:  以插件化构建核心功能, 加以合理的抽象设计,  **YiChenGameplayCore** 插件包含8个功能模块可用于不同类型的游戏项目、**YiChenShooterCore**插件可复用于射击游戏
- **扩展性**:   **Experience框架系统**作为GameMode的高级扩展, 可自由组合搭建出各类游戏模式，库存与装备系统实现了Fragment扩展机制和Definition-Instance模式支持灵活定制，同样可适用于任何类型的游戏去使用
- **性能与开发效率**: 网络复制方面使用FastArray、PushModel优化性能，游戏逻辑方面C++提供核心功能算法，AngelScirpt脚本层编写组合游戏业务逻辑，兼顾性能与开发迭代效率
- **规范性：** 代码实现配备标准整洁的注释说明
  
  

### 1.3 满足大作业要求的功能清单

本项目完整实现了腾讯开局一课游戏客户端训练营的三大核心要求, 并实现了更多高级的框架功能：

| 要求          | 实现方案                                                  |
| ----------- | ----------------------------------------------------- |
| **AI敌人系统**  | 行为树 + EQS + AI感知系统                                    |
| **计分与胜利机制** | 基于GAS的GamePhase阶段管理 + 个人死斗\团队死斗双模式 + 完整计分与胜利机制和对局循环机制 |
| **多人网络对战**  | Dedicated Server / Listen Server，支持Steam广域网联机对战       |

## 

## 二、技术选型思路

#### 2.1 编程语言分层策略

采用 **C++ / AngelScript / 蓝图** 三者混合开发模式，根据功能模块特性选择最合适的语言进行编写，C++层提供核心功能框架及性能敏感功能，AngelScirpt脚本层做Gameplay逻辑，蓝图做资产配置用。这套方案相对理想的发挥了三者各自的优势之处，版本控制也友好。

**作者关于脚本选择更多详细介绍知乎文章：** https://zhuanlan.zhihu.com/p/1979243623313851969



#### 2.1.1 C++ 核心层

**适用场景**: 底层框架、复杂网络复制(如FastArray)、脚本层蓝图层无法实现的功能

在本项目中`YiChenGameCore` 、`YiChenShooterCore`插件使用C++编写, 提供了与具体游戏业务逻辑无关的高性能功能框架基础，供脚本层和蓝图层去组装使用。 



#### 2.1.2 AngelScript 脚本业务层

**适用场景**: 业务逻辑、游戏玩法、快速迭代

**选择原因：** AngelScirpt由双人成行项目组开发, 与引擎做了深度优化, 有双人成行、双影奇境、The finals(终极角逐)等多款知名商业游戏项目使用。**性能达标，类C++语法，学习成本低，无需编译开发迭代效率高，对于性能敏感的功能代码可无痛迁移代码至C++**。可以通过编写Mixin插件扩展更多C++功能至脚本层使用，结合先前个人有大量`AngelScirpt` 的使用经验故选择该脚本语言。

本项目编写脚本功能扩展插件：**/Plugins/YcAngelScriptMixin**



#### 2.1.3 蓝图配置层

**适用场景**: 资产配置(蓝图类默认值、DataTable、DataAsset、DataRegisty)、UMG、简单逻辑、原型验证

利用编辑器强大的功能做资产管理和维护，主要逻辑还是在AngelScirpt、C++中进行实现。



**分层策略总结**：

```
性能要求: 高 ────────────────────────> 低
开发效率: 低 ────────────────────────> 高
         C++        AngelScript      蓝图
         │              │              │
         ▼              ▼              ▼
      核心框架        业务逻辑       资产配置/UMG
```

### 

### 2.2 重点使用到的UE功能模块

#### 2.2.1 Gameplay Ability System (GAS)

**定位**: UE5官方的商业项目级技能系统框架，在堡垒之夜等众多UE5商业项目中被运用

**部分核心价值**：

- **技能管理**: 统一的技能授予、激活、取消机制
- **属性系统**: 支持属性修改、临时效果、永久效果
- **网络同步**: 自动处理技能的网络复制和预测
- **事件驱动**: GameplayCue支持视觉和音效的解耦

**在项目中的应用**：

```
GAS 应用场景:
├── 装备系统: 装备时授予技能集合 (AbilitySet)
├── 武器系统: 射击、换弹、瞄准技能
├── 角色系统: 生命值、护甲、移动速度属性
├── 游戏阶段: 阶段切换通过GAS事件驱动
└── 特效系统: GameplayCue动态加载和播放

技术亮点:
- 装备与技能深度集成，装备即授予技能， 取消装备即取消授予的技能
- 基于GAS的阶段管理，状态驱动游戏流程
- GameplayCue动态加载，避免启动警告
```

#### 

#### 2.2.2 GameFeature 插件系统

**定位**: UE5中可动态装卸的模块化功能系统, 实现对CoreGame的动态修改, 例如堡垒之夜各种特殊限时活动用GameFeature就能非常优雅的实现。

**核心价值**：

- **插件化**: 游戏内容封装为独立插件
- **热插拔**: 运行时激活/停用插件
- **内容隔离**: 避免内容耦合和循环依赖

**在项目中的应用**：

```
GameFeature 架构:
YcShooterExample (GameFeature插件)
├── 各类GameFeatureAction 配置
│   ├── AddComponents (动态添加组件)
│   ├── AddAbilities (动态授予技能)
│   ├── AddGameplayCuePath (动态加载GameplayCue)
│   └── AddInputConfig (动态配置输入)
└── 生命周期管理
    ├── Registering (注册)
    ├── Loading (加载)
    ├── Activating (激活)
    └── Unregistering (注销)

技术亮点:
- 状态观察者模式解决GameplayCue加载时序问题
- 支持运行时动态加载游戏内容
- 避免硬引用，降低内存占用
```

#### 

#### 2.2.3 Enhanced Input System

**定位**: UE5新一代输入系统

**核心价值**：

- **数据驱动**: 输入配置与代码解耦
- **上下文切换**: 支持多套输入方案
- **修饰键**: 支持组合键和连击
- **平台适配**: 自动处理不同平台输入

**在项目中的应用**：

```
在本项目中我们Enhanced Input System和GAS系统做了深度的集成
InputAction -绑定- GameplayTag
GameplayAbility 在授予的时候绑定 GameplayTag
InputAction被按下将其绑定的GameplayTag转发至ASC组件, ASC组件处理技能激活与结束

技术亮点:
- 通过创建UYcGameFeatureAction_AddInputConfigs实现运行时动态修改输入配置
- 与GAS系统做深度集成
```

#### 

#### 2.2.4 数据驱动与资产管理：DataRegisty、DataTable、PrimaryDataAsset、DataAseet

**定位**: 大量数据资产的管理与维护，以数据驱动游戏

**核心价值**：

* **数据与资产管理**: 便于海量数据资产的管理与维护，可避免硬引用资产，制定合理的资产管理与引用加载机制
* **使用便捷**：业务层使用时只需要持有**FDataRegistryID**， 无需关注背后复杂的资产架构逻辑

**在项目中的应用**：

**非数值型资产** ：利用**PrimaryDataAsset**、**DataAseet**包装模型、特效等资产，用**AssetBundles**标识资产分组, 便于进行自定义的资产加载/异步加载逻辑

**数值型资产** ：利用**DataTable**做批量的管理和维护

**两大类资产组合管理：** **DataTable**中用FPrimaryAssetId记录所需的非数值型主资产ID，在运行时通过AssetManager可以加载获取到以便业务使用。
**业务层面的使用：** 通过创建各类型的 **DataRegistry** 聚合各类型的**DataTable**，最终游戏业务层面使用时只需要持有一个**FDataRegistryID**即可。

**详情可查看案例：** `/Plugins/GameFeatues/YcShooterExample/Weapons` 中关于武器数据与资产的组织与使用案例



#### 2.2.5 FastArray 网络同步

**定位**: UE5的增量网络复制机制

**核心价值**：

- **增量复制**: 仅复制变化的数据, 但需要注意客户端不一定保持正确的顺序
- **带宽优化**: 在复杂大数组数据的时候比TArray效率提高很多, 避免一个数据改变导致整个数组重新同步
- **自动回调**: 客户端自动触发Add/Remove/Change回调
- **高效索引**: 支持快速查找和修改，项目用TMap在本地做了查询加速

**在项目中的应用**：

```
FastArray 应用场景:
├── FYcEquipmentList (装备列表)
│   └── 优化: 装备/卸下仅复制单个装备
├── FYcInventoryItemList (库存物品)
│   └── 优化: 添加/移除物品仅复制变化
├── FYcAttachmentArray (配件数据)
│   └── 优化: 配件修改仅复制单个配件
└── FYcGameplayTagStackContainer (Tag堆叠)
    └── 优化: Tag计数变化仅复制单个Tag
```

---

## 三、整体架构设计

在本次项目开发中主要以**插件化、模块化、分层化**思想来组织构建游戏功能代码，做好各功能模块抽象设计，以`GameplayMessageSubsystem` 基于`FGameplayTag`的消息总线子系统解耦各功能模块并支持跨模块通信，实现简洁易用且可复用的游戏功能插件。

### 3.1 插件层级关系图（4层架构）

项目目前采用**自底向上的4层插件架构**，每层职责清晰，依赖关系单向，符合分层设计原则。

![项目框架设计总览](https://i.imgs.ovh/2026/02/01/yW6zCX.png) 

**本次实现的网络射击游戏层级职责说明**：

| 层级        | 插件/模块                 | 职责                                           | 依赖关系  |
| --------- | --------------------- | -------------------------------------------- | ----- |
| **游戏内容层** | YcShooterExample      | 游戏具体内容和配置，如动画蓝图、UMG以及游戏所需的数据资产配置构建           | 依赖游戏层 |
| **游戏逻辑层** | YiChenShooterCore     | 射击游戏专用功能，游戏逻辑层可横向扩展针对不同游戏品类的专属核心功能插件         | 依赖框架层 |
| **游戏框架层** | YiChenGameCore (8个模块) | 通用游戏框架, 集合GAS、GameFeature提供增强版的数据驱动Gamplay框架 | 依赖引擎层 |
| **引擎层**   | UE5 Engine及官方插件       | 引擎核心功能                                       |       |

**设计理念**：

- **单向依赖**: 上层依赖下层，下层不依赖上层，避免循环依赖
- **职责分离**: 每层职责清晰，内容层只关注配置，框架层只关注通用功能
- **可复用性**: 框架层的8个模块可用于其他游戏项目，游戏逻辑层的射击游戏核心插件也可复用与射击游戏项目
- **可扩展性**: 新增游戏功能只需要新增游戏逻辑层、游戏内容层插件即可, 可快速搭建游戏内容
  
  

  ![4e2a4da0-ab08-4426-8e34-7d81467d5512](https://i.imgs.ovh/2026/02/01/yW65Qc.png)
